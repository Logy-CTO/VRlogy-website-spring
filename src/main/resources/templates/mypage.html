<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="HTML5 Template, eSports, Gaming, Tournament, Landing, Page, SEO" />
    <meta name="description" content="Logy - eSports & Gaming HTML5 Template" />
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>Logy</title>

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/venobox/1.9.1/venobox.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/venobox/1.9.1/venobox.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/responsive.css">
</head>

<body id="darkmode">
<!-- Preloader -->
<div class="loader_screen preloader" id="preloader">
    <div class="loader loader-box">
        <svg viewBox="0 0 80 80">
            <rect x="8" y="8" width="64" height="64"></rect>
        </svg>
    </div>
</div>
<!-- Preloader -->

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cart <b>.</b></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- 여기가 상품 정보가 들어갈 곳입니다 -->
            <div class="modal-body" id="cartItemsContainer2">
                <!-- 장바구니 항목이 여기에 동적으로 추가됩니다 -->
            </div>
            <!-- 생략 -->
            <div class="modal-footer">
                <a href="cart" class="main-btn model-btn" id="checkoutButton">Checkout $0</a>
            </div>
        </div>
    </div>
</div>
<!-- Contact Modal -->
<div class="modal fade" id="contact-model-large" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <form th:action="@{/contact}" th:method="post">
                <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                <div class="modal-header">
                    <h5 class="modal-title">Contact <b>.</b></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row contact-box">
                        <div class="col-lg-6">
                            <div class="form-group">
                                <input type="text" name="username" class="form-control" placeholder="Your Full Name" required>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="form-group">
                                <input type="email" name="useremail" class="form-control" placeholder="Your Email Address" required>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="form-group">
                                <textarea class="form-control" name="usermessage" id="exampleFormControlTextarea1" rows="7" placeholder="Your Message" required></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="main-btn model-btn">Send Message</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Modal -->

<!-- HEADER AREA START -->
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top" id="navber">
    <div class="container">
        <a class="navbar-brand" href="/">Logy<span>.</span></a>
        <div class="menu-main" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto menu-item">
                <li class="nav-item">
                    <a class="nav-link nl-m-top abc mobile-content-hide"><i class="fa fa-search" aria-hidden="true"></i></a>
                    <div class="search top-search">
                        <button type="button" class="close fix-close">×</button>
                        <form>
                            <input type="search" value="" placeholder="Search Here" />
                            <button type="submit" class="btn btn-primary">Search</button>
                        </form>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link cart nl-m-top mobile-content-hide" data-toggle="modal" data-target="#exampleModalCenter"><i class="fa fa-shopping-bag" aria-hidden="true"></i><span id="cartItemCount">0</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nl-m-top account-icon" id="loginBtn" href="login"><i class="fa fa-user" aria-hidden="true"></i></a>
                    <a class="nav-link nl-m-top account-icon" id="logoutBtn" href="#"><i class="fas fa-sign-out-alt" aria-hidden="true"></i></a>
                </li>
                <li class="nav-item">
                    <!-- 마이페이지 버튼 -->
                    <a class="nav-link nl-m-top account-icon" id="myPageBtn" href="mypage"><i class="fa fa-user-circle" aria-hidden="true"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link menu-icon"><i class="fa fa-bars" aria-hidden="true"></i></a>
                </li>
            </ul>
        </div>
    </div>
    <div class="custom-menubar">
        <ul class="nav-link-block">
            <li>
                <a href="/" class="menu-link">Home</a>
            </li>
        </ul>
        <ul class="responsive-nav">
            <li>
                <a class="nav-link nl-m-top abc"><i class="fa fa-search" aria-hidden="true"></i></a>
                <div class="search top-search">
                    <button type="button" class="close fix-close">×</button>
                    <form>
                        <input type="search" value="" placeholder="Search Here" />
                        <button type="submit" class="btn btn-primary">Search</button>
                    </form>
                </div>
            </li>
            <li>
                <a class="nav-link cart nl-m-top" data-toggle="modal" data-target="#exampleModalCenter"><i class="fa fa-shopping-bag" aria-hidden="true"></i><span id="cartItemCountNavbar">0</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link nl-m-top" id="loginBtnMobile" href="login"><i class="fa fa-user" aria-hidden="true"></i></a>
                <a class="nav-link nl-m-top" id="logoutBtnMobile" href="#"><i class="fas fa-sign-out-alt" aria-hidden="true"></i></a>
            </li>
            <li class="nav-item">
                <a class="nav-link nl-m-top" id="myPageBtnMobile" href="mypage"><i class="fa fa-user-circle" aria-hidden="true"></i></a>
            </li>
        </ul>
        <div class="menu-close">
            <a class="hide-menu-btn"><i class="fa fa-times" aria-hidden="true"></i></a>
        </div>
    </div>
</nav>
<!-- HEADER AREA END -->
<style>
    .half-size-btn {
        padding: 10px 20px;
        font-size: 1rem;
    }

    .smaller-placeholder::placeholder {
        font-size: 0.8rem;
        color: white;
    }

    .contact-box .form-control {
        margin-top: 0px;
    }

    .centered-content {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding-top: 150px; /* 상단 패딩 추가 */
        min-height: 100vh;
    }

    h4, p {
        color: white;
        margin-bottom: 30px;
    }

    .valid-text {
        color: green;
        font-weight: bold;
    }

    .form-control {
        width: 200%;
        height: 40px; /* input 필드의 세로 길이를 조절 */
    }

    .contact-box {
        margin-bottom: 40px; /* 간격 조절 between contact-boxes */
    }
</style>

<div class="container centered-content">
    <div class="col-lg-8">
        <h4>Name Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="text" id="currentName" placeholder="" disabled class="form-control smaller-placeholder"><br/>
                    <input type="text" id="newName" placeholder="New Name" required autocomplete="off" class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updateNameBtn">Update Name</button>
                </div>
            </div>
        </div>

        <h4>Email Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="email" id="currentEmail" placeholder="" disabled class="form-control smaller-placeholder"><br/>
                    <input type="email" id="newEmail" placeholder="New Email Address" required autocomplete="off" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updateEmailBtn">Update Email</button>
                </div>
            </div>
        </div>

        <h4>Password Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="password" id="currentPassword" placeholder="********" required autocomplete="off" pattern=".{8,}" title="Enter a password of 8 characters or more." class="form-control smaller-placeholder"><br/>
                    <input type="password" id="newPassword" placeholder="New Password" required autocomplete="off" pattern=".{8,}" title="Enter a password of 8 characters or more." class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updatePasswordBtn">Update Password</button>
                </div>
            </div>
        </div>

        <h4>Phone Number Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="tel" id="currentPhoneNumber" placeholder="" required autocomplete="off" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" title="Enter a valid phone number." class="form-control smaller-placeholder"><br/>
                    <input type="tel" id="newPhoneNumber" placeholder="New Phone Number" required autocomplete="off" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" title="Enter a valid phone number." class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updatePhoneNumberBtn">Update Phone Number</button>
                </div>
            </div>
        </div>

        <h4>Address Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="text" id="currentAddress" placeholder="" disabled class="form-control smaller-placeholder"><br/>
                    <input type="text" id="newAddress" placeholder="New Address" required autocomplete="off" class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updateAddressBtn">Search Address</button>
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updateABtn">Update Address</button>
                </div>
            </div>
        </div>

        <h4>Postcode Update</h4>
        <div class="row contact-box">
            <div class="col-lg-6">
                <div class="form-group">
                    <input type="text" id="currentPostcode" placeholder="" disabled class="form-control smaller-placeholder"><br/>
                    <input type="text" id="newPostcode" placeholder="New Postcode" required autocomplete="off" class="form-control smaller-placeholder">
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updatePostcodeBtn">Search Address</button>
                    <button type="button" class="btn btn-primary mt-2 main-btn half-size-btn" id="updatePBtn">Update Address</button>
                </div>
            </div>
        </div>

        <h4>VRlogy Program License Information</h4>
        <div class="row">
            <div class="col-md-6">
                <p>License: <span id="licenseStatus"></span></p>
                <p id="expirationDate"></p>
            </div>
        </div>

        <h4>Total calories burned</h4>
        <div class="row">
            <div class="col-md-6">
                <p>calories: <span id="CaloriesBurned"></span></p>
                <p>date: <span id="CalorieDate"></span></p>
            </div>
        </div>
    </div>
</div>

<!-- Email Update Section -->

<!-- FOOTER AREA START -->
<section id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 footer-logo">
                <a href="/" style="color: gray;">Logy<b>.</b></a>
                <p style="color: gray;">Step into the Future with logy: Elevating Reality through VR Treadmills and Software Solutions</p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 footer-info">
                <p style="color: gray;">회사명: 로지 | 대표: 홍택수 | 사업자번호: 888-08-02952</p>
                <p style="color: gray;">고객센터: 010-3149-5281 | 주소: 충청남도 서산시 해미면 한서1로 46 산학협력관 지하 1층 멀티라운지</p>
                <p style="color: gray;">
                    <br>
                    <a href="#" data-toggle="modal" data-target="#termsModal" style="color: gray;">이용약관</a> |
                    <a href="#" data-toggle="modal" data-target="#privacyModal" style="color: gray;">개인정보처리방침</a> |
                    <a href="#" data-toggle="modal" data-target="#refundModal" style="color: gray;">환불정책</a>
                </p>
            </div>
        </div>
    </div>
</section>

<!-- 이용약관 Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" role="dialog" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="termsModalLabel" style="color: gray;">이용약관</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="overflow-y: scroll; max-height: 400px; color: gray;">
                <h4 style="color: gray;">제1조 목적</h4>
                <p>본 약관은 로지(이하 "회사")가 제공하는 서비스의 이용과 관련하여 회사와 이용자의 권리, 의무 및 책임사항을 규정함을 목적으로 합니다.</p>

                <br>

                <h4 style="color: gray;">제2조 정의</h4>
                <p>1. "서비스"란 회사가 제공하는 모든 웹사이트, 애플리케이션, 기타 서비스를 의미합니다.<br>2. "이용자"란 본 약관에 따라 회사가 제공하는 서비스를 이용하는 회원 및 비회원을 말합니다.</p>

                <br>

                <h4 style="color: gray;">제3조 약관의 명시, 효력 및 변경</h4>
                <p>1. 회사는 본 약관의 내용을 이용자가 알 수 있도록 서비스 화면에 게시합니다.<br>2. 회사는 관련 법령을 위배하지 않는 범위에서 본 약관을 변경할 수 있으며, 변경된 약관은 서비스 화면에 공지합니다.</p>

                <br>

                <h4 style="color: gray;">제4조 서비스 이용</h4>
                <p>1. 이용자는 본 약관에 동의함으로써 회사가 제공하는 서비스를 이용할 수 있습니다.<br>2. 서비스는 연중무휴 24시간 제공함을 원칙으로 하나, 시스템 점검 및 기타 기술적 문제로 인해 일시 중단될 수 있습니다.</p>

                <br>

                <h4 style="color: gray;">제5조 개인정보 보호</h4>
                <p>회사는 이용자의 개인정보를 관련 법령 및 개인정보처리방침에 따라 보호하며, 이에 관한 사항은 별도의 개인정보처리방침에 따릅니다.</p>

                <br>

                <h4 style="color: gray;">제6조 이용자의 의무</h4>
                <p>이용자는 다음 각 호에 해당하는 행위를 해서는 안 됩니다:<br>1. 타인의 개인정보를 도용하는 행위<br>2. 회사의 지적 재산권 침해<br>3. 법령에 위반되는 행위</p>

                <br>

                <h4 style="color: gray;">제7조 서비스 이용의 제한 및 종료</h4>
                <p>회사는 이용자가 본 약관을 위반할 경우 서비스 이용을 제한하거나 중단할 수 있으며, 이로 인한 책임은 이용자에게 있습니다.</p>

                <br>

                <h4 style="color: gray;">제8조 면책사항</h4>
                <p>회사는 천재지변, 전쟁, 파업 등 불가항력적인 상황으로 인한 서비스 중단에 대해 책임을 지지 않습니다.</p>

                <br>

                <h4 style="color: gray;">제9조 기타</h4>
                <p>본 약관은 대한민국 법률에 따라 해석되며, 분쟁이 발생할 경우 회사의 본사 소재지를 관할하는 법원을 관할 법원으로 합니다.</p>
            </div>
        </div>
    </div>
</div>

<!-- 개인정보처리방침 Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" role="dialog" aria-labelledby="privacyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="privacyModalLabel" style="color: gray;">개인정보처리방침</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="overflow-y: scroll; max-height: 400px; color: gray;">
                <h4 style="color: gray;">1. 개인정보 수집 항목</h4>
                <p>회사는 회원가입, 상담, 서비스 신청 등을 위해 아래와 같은 개인정보를 수집하고 있습니다.</p>

                <br>

                <ul style="color: gray;">
                    <li>수집 항목: 이름, 이메일, 주소, 전화번호, 결제 정보 등</li>
                </ul>

                <br>

                <h4 style="color: gray;">2. 개인정보 수집 목적</h4>
                <p>회사는 다음과 같은 목적을 위해 개인정보를 수집합니다:<br>1. 서비스 제공 및 본인 인증<br>2. 고객 관리 및 문의 처리<br>3. 마케팅 및 광고에 활용</p>

                <br>

                <h4 style="color: gray;">3. 개인정보 보유 및 이용기간</h4>
                <p>회사는 이용자의 개인정보를 회원탈퇴 후 지체 없이 파기하며, 다만 관련 법령에 의해 일정 기간 보관이 필요할 경우 그 기간 동안 보관합니다.</p>

                <br>

                <h4 style="color: gray;">4. 개인정보의 제3자 제공</h4>
                <p>회사는 이용자의 동의 없이 개인정보를 외부에 제공하지 않으며, 법령에 의한 경우에 한해 제3자에게 제공할 수 있습니다.</p>

                <br>

                <h4 style="color: gray;">5. 개인정보의 안전성 확보 조치</h4>
                <p>회사는 이용자의 개인정보를 보호하기 위해 다음과 같은 조치를 취하고 있습니다:<br>1. 개인정보 암호화<br>2. 접근 통제 및 관리<br>3. 내부 감사 및 교육</p>

                <br>

                <h4 style="color: gray;">6. 이용자의 권리</h4>
                <p>이용자는 언제든지 자신의 개인정보를 조회, 수정 및 삭제 요청할 수 있으며, 회사는 이에 신속하게 대응합니다.</p>

                <br>

                <h4 style="color: gray;">7. 개인정보 보호 책임자</h4>
                <p>회사는 이용자의 개인정보를 보호하고 관련 불만을 처리하기 위해 개인정보 보호 책임자를 지정하고 있습니다. 자세한 사항은 회사의 홈페이지를 참조하십시오.</p>
            </div>
        </div>
    </div>
</div>

<!-- 환불정책 Modal -->
<div class="modal fade" id="refundModal" tabindex="-1" role="dialog" aria-labelledby="refundModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="refundModalLabel" style="color: gray;">환불정책</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="overflow-y: scroll; max-height: 400px; color: gray;">
                <h4 style="color: gray;">1. 환불 가능 조건</h4>
                <p>다음의 경우 환불이 가능합니다:<br>1. 제품 불량 및 결함으로 인한 환불<br>2. 제품 미사용 및 구매 후 7일 이내 요청 시</p>

                <br>

                <h4 style="color: gray;">2. 환불 불가 조건</h4>
                <p>다음의 경우 환불이 불가합니다:<br>1. 소비자의 과실로 인해 제품이 손상된 경우<br>2. 구매 후 7일이 경과한 경우</p>

                <br>

                <h4 style="color: gray;">3. 환불 절차</h4>
                <p>환불 요청은 고객센터를 통해 접수되며, 승인된 경우 7일 이내에 결제 수단으로 환불이 처리됩니다.</p>

                <br>

                <h4 style="color: gray;">4. 제품 교환</h4>
                <p>제품에 결함이 있는 경우, 구매일로부터 30일 이내에 교환이 가능합니다. 교환을 원하실 경우 고객센터로 문의해주시기 바랍니다.</p>

                <br>

                <h4 style="color: gray;">5. 환불 관련 문의</h4>
                <p>환불 관련 문의사항은 고객센터로 연락 주시면 신속하게 처리해드리겠습니다. 고객센터 연락처: 010-3149-5271</p>
            </div>
        </div>
    </div>
</div>
<!-- FOOTER AREA END -->

<!-- COPY_RIGHT AREA START -->
<section id="copy_right">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6 col-sm-7 copy-right-txt">
                        <p><i class="fa fa-copyright" aria-hidden="true"></i> 2021-2030 - Developed by <a href="#">Logy Team.</a></p>
                    </div>
                    <div class="col-lg-6 col-sm-5 text-right copy-right-txt">
                        <p>All Rights Reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- COPY_RIGHT AREA END -->

<!-- JavaScript -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/venobox/1.9.1/venobox.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>
<script src="/js/counterup.min.js"></script>
<script src="/js/waypoints.min.js"></script>
<script src="/js/custom.js"></script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

<script>
    $(document).ready(function() {
        // Set CSRF token header for all AJAX requests
        var csrfToken = $('meta[name="_csrf"]').attr('content');
        var csrfHeader = $('meta[name="_csrf_header"]').attr('content');

        $.ajaxSetup({
            beforeSend: function(xhr) {
                xhr.setRequestHeader(csrfHeader, csrfToken);
            }
        });

        function loadCartItems() {
            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        let currentMemberId = response.username;

                        $.ajax({
                            url: '/get-cart-items',
                            method: 'GET',
                            data: { memberId: currentMemberId },
                            success: function(response) {
                                let cartItemsContainer2 = $('#cartItemsContainer2');
                                cartItemsContainer2.empty();
                                let totalAmount = response.reduce((sum, cartItem) => sum + parseFloat(cartItem.amount), 0);
                                $('#subtotal-value').text(`$${totalAmount.toFixed(2)}`);
                                $('#total-value').text(`$${totalAmount.toFixed(2)}`);
                                $('#checkoutButton').text(`Checkout $${totalAmount.toFixed(2)}`);
                                $('#cartItemCount').text(response.length);
                                $('#cartItemCountNavbar').text(response.length);

                                response.forEach(cartItem => {
                                    let imagePath = "";
                                    switch(cartItem.productName) {
                                        case "PICO 4":
                                            imagePath = "/images/35059704619.20221216134925.jpg";
                                            break;
                                        case "C920 PRO":
                                            imagePath = "/images/16646684053.20181217180044.jpg";
                                            break;
                                        case "Oculus Quest 2":
                                            imagePath = "/images/30612946625.20230130153345.jpg";
                                            break;
                                        case "VRlogy treadmill":
                                            imagePath = "/images/KATWALKC2.jpg";
                                            break;
                                        case "VRlogy Program":
                                            imagePath = "/images/KakaoTalk_Photo_2023-09-07-23-39-23.png";
                                            break;
                                        default:
                                            imagePath = "";
                                            break;
                                    }

                                    let itemHtml2 = `
                                <div class="row cart-item">
                                    <div class="col-sm-4 col-lg-4 cart-img">
                                        <img src="${imagePath}" alt="${cartItem.productName}" class="img-fluid">
                                        <a href="#" class="deleteCartItem" data-product-name="${cartItem.productName}"><i class="fa fa-trash" aria-hidden="true"></i></a>
                                    </div>
                                    <div class="col-sm-8 col-lg-8">
                                        <h3>${cartItem.productName}</h3>
                                        <span>$${cartItem.amount}</span>
                                    </div>
                                </div>
                                `;
                                    cartItemsContainer2.append(itemHtml2);
                                });

                                $('#cartItemsContainer2').on('click', '.deleteCartItem', function(e) {
                                    e.preventDefault();
                                    let productName = $(this).data('product-name');
                                    $.ajax({
                                        url: '/delete-cart-item',
                                        method: 'POST',
                                        contentType: 'application/json',
                                        data: JSON.stringify({
                                            productName: productName,
                                            memberId: currentMemberId
                                        }),
                                        success: function(deleteResponse) {
                                            if (deleteResponse.status === "success") {
                                                loadCartItems();
                                            } else {
                                                alert(deleteResponse.message);
                                            }
                                        },
                                        error: function(xhr) {
                                            console.error('Error deleting cart item:', xhr);
                                            alert("Failed to delete cart item.");
                                        }
                                    });
                                });
                            },
                            error: function(xhr) {
                                console.error('Error fetching cart items:', xhr);
                                alert("Failed to fetch cart items.");
                            }
                        });
                    }
                },
                error: function(xhr) {
                    console.error('Error checking authentication:', xhr);
                }
            });
        }

        loadCartItems();

        $.ajax({
            type: "GET",
            url: "/mypage/getCurrentUserInfo",
            success: function(data) {
                $("#currentName").val(data.name);
                $("#currentEmail").val(data.username);
                $("#currentPhoneNumber").val(data.phoneNumber);
                $("#currentAddress").val(data.address);
                $("#currentPostcode").val(data.postcode);
            },
            error: function(error) {
                console.error('Error fetching user info:', error);
            }
        });

        $("#updateNameBtn").click(function() {
            let newName = $("#newName").val();
            if (newName) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updateName",
                    data: JSON.stringify({ value: newName }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            $("#currentName").val(newName);
                            alert("Updated successfully.");
                        } else {
                            alert("Error updating name.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating name:', xhr);
                        alert(xhr.responseText); // 서버에서 보낸 에러 메시지 표시
                    }
                });
            }
        });

        $("#updateEmailBtn").click(function() {
            let newEmail = $("#newEmail").val();
            if (newEmail) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updateEmail",
                    data: JSON.stringify({ value: newEmail }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            $("#currentEmail").val(newEmail);
                            alert("Updated successfully.");
                            updateSessionEmail(newEmail);
                        } else {
                            alert("Error updating email.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating email:', xhr);
                        if(xhr.status === 400) {
                            alert(xhr.responseText); // 에러 메시지 표시
                        } else {
                            alert('Failed to update email.');
                        }
                    }
                });
            }
        });

        function updateSessionEmail(newEmail) {
            $.ajax({
                type: "POST",
                url: "/mypage/updateSessionEmail",
                data: JSON.stringify({ value: newEmail }),
                contentType: "application/json",
                success: function(response) {
                    if (response === "Session updated") {
                        console.log("Session email updated successfully.");
                    } else {
                        alert("Error updating session email.");
                    }
                },
                error: function(xhr) {
                    console.error('Error updating session email:', xhr);
                    if(xhr.status === 400) {
                        alert(xhr.responseText); // 에러 메시지 표시
                    } else {
                        alert('Failed to update session email.');
                    }
                }
            });
        }

        $("#updatePasswordBtn").click(function() {
            let newPassword = $("#newPassword").val();
            if (newPassword) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updatePassword",
                    data: JSON.stringify({ value: newPassword }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            alert("Updated successfully.");
                        } else {
                            alert("Error updating password.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating password:', xhr);
                        if(xhr.status === 400) {
                            alert(xhr.responseText); // 에러 메시지 표시
                        } else {
                            alert('Failed to update password.');
                        }
                    }
                });
            }
        });

        $("#updatePhoneNumberBtn").click(function() {
            let newPhoneNumber = $("#newPhoneNumber").val();
            if (newPhoneNumber) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updatePhoneNumber",
                    data: JSON.stringify({ value: newPhoneNumber }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            $("#currentPhoneNumber").val(newPhoneNumber);
                            alert("Updated successfully.");
                        } else {
                            alert("Error updating phone number.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating phone number:', xhr);
                        if(xhr.status === 400) {
                            alert(xhr.responseText); // 에러 메시지 표시
                        } else {
                            alert('Failed to update phone number.');
                        }
                    }
                });
            }
        });

        $("#updateABtn").click(function() {
            let newAddress = $("#newAddress").val();
            if (newAddress) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updateAddress",
                    data: JSON.stringify({ value: newAddress }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            $("#currentAddress").val(newAddress);
                            alert("Updated successfully.");
                        } else {
                            alert("Error updating address.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating address:', xhr);
                        if(xhr.status === 400) {
                            alert(xhr.responseText); // 에러 메시지 표시
                        } else {
                            alert('Failed to update address.');
                        }
                    }
                });
            }
        });

        $("#updatePBtn").click(function() {
            let newPostcode = $("#newPostcode").val();
            if (newPostcode) {
                $.ajax({
                    type: "POST",
                    url: "/mypage/updatePostcode",
                    data: JSON.stringify({ value: newPostcode }),
                    contentType: "application/json",
                    success: function(response) {
                        console.log(response);
                        if (response === "Updated successfully.") {
                            $("#currentPostcode").val(newPostcode);
                            alert("Updated successfully.");
                        } else {
                            alert("Error updating postcode.");
                        }
                    },
                    error: function(xhr) {
                        console.error('Error updating postcode:', xhr);
                        if(xhr.status === 400) {
                            alert(xhr.responseText); // 에러 메시지 표시
                        } else {
                            alert('Failed to update postcode.');
                        }
                    }
                });
            }
        });

        function sample6_execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function(data) {
                    var addr = '';
                    var extraAddr = '';
                    if (data.userSelectedType === 'R') {
                        addr = data.roadAddress;
                    } else {
                        addr = data.jibunAddress;
                    }

                    if(data.userSelectedType === 'R'){
                        if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                            extraAddr += data.bname;
                        }
                        if(data.buildingName !== '' && data.apartment === 'Y'){
                            extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                        }
                        if(extraAddr !== ''){
                            extraAddr = ' (' + extraAddr + ')';
                        }
                        document.getElementById("newAddress").value = addr + extraAddr;
                    } else {
                        document.getElementById("newAddress").value = '';
                    }

                    document.getElementById('currentAddress').value = addr;
                    document.getElementById('newPostcode').value = data.zonecode;
                    document.getElementById("currentPostcode").value = data.zonecode;
                    document.getElementById("sample6_detailAddress").focus();
                }
            }).open();
        }

        $("#updateAddressBtn").click(function() {
            sample6_execDaumPostcode();
        });

        $("#updatePostcodeBtn").click(function() {
            sample6_execDaumPostcode();
        });

        function checkAuthentication() {
            var loginBtn = $('#loginBtn');
            var logoutBtn = $('#logoutBtn');
            var loginBtnMobile = $('#loginBtnMobile');
            var logoutBtnMobile = $('#logoutBtnMobile');

            function handleViewportChange() {
                var viewportWidth = window.innerWidth || document.documentElement.clientWidth;

                if (viewportWidth < 992) {
                    loginBtn.hide();
                    logoutBtn.hide();
                    $.ajax({
                        url: '/check-authentication',
                        method: 'GET',
                        success: function(response) {
                            if (response.authenticated) {
                                loginBtnMobile.hide();
                                logoutBtnMobile.show();
                            } else {
                                loginBtnMobile.show();
                                logoutBtnMobile.hide();
                            }
                        },
                        error: function(xhr) {
                            console.error('Error checking authentication:', xhr);
                        }
                    });
                } else {
                    $.ajax({
                        url: '/check-authentication',
                        method: 'GET',
                        success: function(response) {
                            if (response.authenticated) {
                                loginBtn.hide();
                                logoutBtn.show();
                            } else {
                                loginBtn.show();
                                logoutBtn.hide();
                            }
                        },
                        error: function(xhr) {
                            console.error('Error checking authentication:', xhr);
                        }
                    });
                }
            }

            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        loginBtn.hide();
                        logoutBtn.show();
                    } else {
                        loginBtn.show();
                        logoutBtn.hide();
                    }
                },
                error: function(xhr) {
                    console.error('Error checking authentication:', xhr);
                }
            });

            handleViewportChange();
            window.addEventListener('resize', handleViewportChange);

            $('#logoutBtn').click(function(e) {
                e.preventDefault();
                logout();
            });
            $('#logoutBtnMobile').click(function(e) {
                e.preventDefault();
                logout();
            });

            function logout() {
                $.ajax({
                    url: '/logout',
                    method: 'POST',
                    data: {
                        _token: $('meta[name="csrf-token"]').attr('content') // CSRF 토큰 추가
                    },
                    success: function(response) {
                        window.location.href = '/';
                    },
                    error: function(xhr) {
                        console.error('Error logging out:', xhr);
                    }
                });
            }
        }

        checkAuthentication();

        $.ajax({
            type: "GET",
            url: "/mypage/licenseInfo",
            success: function(licenseInfo) {
                if (licenseInfo.status === "Valid") {
                    $("#licenseStatus").html('<span style="color: green; font-weight: bold;">Valid</span>');
                    $("#expirationDate").text("Expiration Date: " + licenseInfo.expirationDate);
                } else {
                    $("#licenseStatus").html('<span style="color: red; font-weight: bold;">Invalid</span>');
                    $("#expirationDate").text("");
                }
            },
            error: function(error) {
                console.error("Error fetching license information:", error);
            }
        });

        $.ajax({
            url: '/mypage/calorieInfo',
            type: 'GET',
            success: function(data) {
                $('#CaloriesBurned').text("Calories: " + data.calorie);
                $('#CalorieDate').text("Date: " + data.date);
            },
            error: function(error) {
                console.error('Error fetching calorie info:', error);
            }
        });
    });

</script>


</body>

</html>
