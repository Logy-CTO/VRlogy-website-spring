<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="HTML5 Template, eSports, Gaming, Tournament, Landing, Page, SEO" />
    <meta name="description" content="Logy - eSports & Gaming HTML5 Template" />
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>Logy</title>

    <!--font-awesome icons link-->
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <!-- Add Font Awesome CSS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/slick.css">
    <link rel="stylesheet" href="/css/venobox.css">
    <link rel="stylesheet" href="/css/lightbox.min.css">
    <!--main style file-->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/responsive.css">
</head>

<body id="darkmode" onload="checkAuthentication()">

<!-- Preloader -->
<div class="loader_screen preloader" id="preloader">
    <div class="loader loader-box">
        <svg viewBox="0 0 80 80">
            <rect x="8" y="8" width="64" height="64"></rect>
        </svg>
    </div>
</div>
<!-- Preloader -->

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cart <b>.</b></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- 여기가 상품 정보가 들어갈 곳입니다 -->
            <div class="modal-body" id="cartItemsContainer2">
                <!-- 장바구니 항목이 여기에 동적으로 추가됩니다 -->
            </div>

            <!-- 생략 -->
            <div class="modal-footer">
                <a href="cart" class="main-btn model-btn" id="checkoutButton">Checkout $0</a>
            </div>
        </div>
    </div>
</div>
<!-- Contact Modal -->
<div class="modal fade" id="contact-model-large" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <form th:action="@{/contact}" th:method="post">
                <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                <div class="modal-header">
                    <h5 class="modal-title">Contact <b>.</b></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row contact-box">
                        <div class="col-lg-6">
                            <div class="form-group">
                                <input type="text" name="username" class="form-control" placeholder="Your Full Name" required>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="form-group">
                                <input type="email" name="useremail" class="form-control" placeholder="Your Email Address" required>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="form-group">
                                <textarea class="form-control" name="usermessage" id="exampleFormControlTextarea1" rows="7" placeholder="Your Message" required></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="main-btn model-btn">Send Message</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Modal -->

<!-- HEADER AREA START -->
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top" id="navber">
    <div class="container">
        <a class="navbar-brand" href="/">Logy<span>.</span></a>
        <div class="menu-main" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto menu-item">
                <li class="nav-item">
                    <a class="nav-link nl-m-top abc mobile-content-hide"><i class="fa fa-search" aria-hidden="true"></i></a>
                    <div class="search top-search">
                        <button type="button" class="close fix-close">×</button>
                        <form>
                            <input type="search" value="" placeholder="Search Here" />
                            <button type="submit" class="btn btn-primary">Search</button>
                        </form>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link cart nl-m-top mobile-content-hide" data-toggle="modal" data-target="#exampleModalCenter"><i class="fa fa-shopping-bag" aria-hidden="true"></i><span id="cartItemCount">0</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nl-m-top account-icon" id="loginBtn" href="login"><i class="fa fa-user" aria-hidden="true"></i></a>
                    <a class="nav-link nl-m-top account-icon" id="logoutBtn" href="#"><i class="fas fa-sign-out-alt" aria-hidden="true"></i></a>
                </li>
                <li class="nav-item">
                    <!-- 마이페이지 버튼 -->
                    <a class="nav-link nl-m-top account-icon" id="myPageBtn" href="mypage"><i class="fa fa-user-circle" aria-hidden="true"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link menu-icon"><i class="fa fa-bars" aria-hidden="true"></i></a>
                </li>
            </ul>
        </div>
    </div>
    <div class="custom-menubar">
        <ul class="nav-link-block">
            <li>
                <a href="/" class="menu-link">Home</a>
            </li>
            <li>
                <a class="menu-link" data-toggle="modal" data-target="#contact-model-large">Contact</a>
            </li>
        </ul>
        <ul class="responsive-nav">
            <li>
                <a class="nav-link nl-m-top abc"><i class="fa fa-search" aria-hidden="true"></i></a>
                <div class="search top-search">
                    <button type="button" class="close fix-close">×</button>
                    <form>
                        <input type="search" value="" placeholder="Search Here" />
                        <button type="submit" class="btn btn-primary">Search</button>
                    </form>
                </div>
            </li>
            <li>
                <a class="nav-link cart nl-m-top" data-toggle="modal" data-target="#exampleModalCenter"><i class="fa fa-shopping-bag" aria-hidden="true"></i><span id="cartItemCountNavbar">0</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link nl-m-top" id="loginBtnMobile" href="login"><i class="fa fa-user" aria-hidden="true"></i></a>
                <a class="nav-link nl-m-top" id="logoutBtnMobile" href="#"><i class="fas fa-sign-out-alt" aria-hidden="true"></i></a>
            </li>
            <li class="nav-item">
                <a class="nav-link nl-m-top" id="myPageBtnMobile" href="mypage"><i class="fa fa-user-circle" aria-hidden="true"></i></a>
            </li>
        </ul>
        <div class="menu-close">
            <a class="hide-menu-btn"><i class="fa fa-times" aria-hidden="true"></i></a>
        </div>
    </div>
</nav>
<!-- HEADER AREA END -->

<!-- BANNER AREA START -->
<section id="banner">
    <div class="backtotop">
        <a href="#banner"><i class="fa fa-angle-up" aria-hidden="true"></i></a>
    </div>
    <div class="follow-us">
        <span>Follow us</span>
        <a href="#"><i class="fa fa-twitch" aria-hidden="true"></i></a>
        <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
        <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
        <a href="#"><i class="fa fa-youtube-play" aria-hidden="true"></i></a>
    </div>
    <div class="banner-arrow">
        <i class="fa fa-angle-left arrow-al" aria-hidden="true"></i>
        <i class="fa fa-angle-right arrow-ar" aria-hidden="true"></i>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-sm-8 col-md-6 landscape-m-auto tab-m-auto banner-img">
                <img src="/images/banner1.png" alt="banner-img" class="img-fluid">
                <a class="vid-btn venobox" data-autoplay="true" data-vbtype="video" href="https://www.youtube.com/watch?v=lWTFCPmjlAE&ab_channel=BeardoBenjo"><i class="fa fa-play" aria-hidden="true"></i></a>
            </div>
            <div class="col-lg-5 m-auto banner-txt">
                <div class="banner-main">
                    <div class="banner-item">
                        <h3>VRlogy</h3>
                        <h3>Download</h3>
                        <p>Step into the Future with logy: Elevating Reality through VR Treadmills and Software Solutions.</p>
                        <a href="/download" class="main-btn">Download Program</a>
                    </div>
                    <div class="banner-item">
                        <h3>Join</h3>
                        <h3>Community</h3>
                        <p>Join our community and stay ahead with Logy's cutting-edge VR Treadmills and Software Solutions.</p>
                        <a href="https://discord.gg/vUcMyRfP" class="main-btn">Join Discord</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- BANNER AREA END -->

<!-- TREADMILL INTRODUCTION START -->
<section id="treadmill-intro" class="mt-custom">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 heading">
                <h3>VRlogy Intro</h3>
            </div>
        </div>
        <div class="row treadmill-slider">
            <div class="col-lg-12">
                <div class="treadmill-slider-for">
                    <div><img src="/images/Treadmill_1.jpg" alt="Treadmill_1" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_2.jpg" alt="Treadmill_2" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_3.jpg" alt="Treadmill_3" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_4.jpg" alt="Treadmill_4" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_5.jpg" alt="Treadmill_5" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_6.jpg" alt="Treadmill_6" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_7.jpg" alt="Treadmill_7" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_8.jpg" alt="Treadmill_8" class="img-fluid"></div>
                </div>
                <div class="treadmill-slider-nav">
                    <div><img src="/images/Treadmill_1.jpg" alt="Treadmill_1" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_2.jpg" alt="Treadmill_2" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_3.jpg" alt="Treadmill_3" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_4.jpg" alt="Treadmill_4" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_5.jpg" alt="Treadmill_5" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_6.jpg" alt="Treadmill_6" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_7.jpg" alt="Treadmill_7" class="img-fluid"></div>
                    <div><img src="/images/Treadmill_8.jpg" alt="Treadmill_8" class="img-fluid"></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- TREADMILL INTRODUCTION END -->

<!-- PRODUCT AREA START -->
<section id="product">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 heading">
                <h3>Product</h3>
            </div>
        </div>
        <div class="row product-pa">
            <div class="col-lg-12">
                <div class="product-main">
                    <div class="col-lg-3 text-center">
                        <div class="product-item">
                            <h3>$9.8</h3>
                            <img src="/images/KakaoTalk_Photo_2023-09-07-23-39-23.png" alt="product-img" class="img-fluid">
                            <h4>VRlogy Program</h4>
                            <a href="#" class="product-btn addToCartButton" data-product-name="VRlogy Program" data-amount="9.8">Add to Cart</a>
                        </div>
                    </div>
                    <div class="col-lg-3 text-center">
                        <div class="product-item">
                            <h3>$439</h3>
                            <div class="sale">
                                <span>Sale</span>
                            </div>
                            <img src="/images/KATWALKC2.jpg" alt="product-img" class="img-fluid">
                            <h4>VRlogy treadmill</h4>
                            <a href="#" class="product-btn addToCartButton" data-product-name="VRlogy treadmill" data-amount="439">Add to Cart</a>
                        </div>
                    </div>
                    <div class="col-lg-3 text-center">
                        <div class="product-item">
                            <h3>$299</h3>
                            <img src="/images/30612946625.20230130153345.jpg" alt="product-img" class="img-fluid">
                            <h4>Oculus Quest 2</h4>
                            <a href="#" class="product-btn addToCartButton" data-product-name="Oculus Quest 2" data-amount="299">Add to Cart</a>
                        </div>
                    </div>
                    <div class="col-lg-3 text-center">
                        <div class="product-item">
                            <h3>$458</h3>
                            <div class="sale">
                                <span>Sale</span>
                            </div>
                            <img src="/images/35059704619.20221216134925.jpg" alt="product-img" class="img-fluid">
                            <h4>PICO 4</h4>
                            <a href="#" class="product-btn addToCartButton" data-product-name="PICO 4" data-amount="458">Add to Cart</a>
                        </div>
                    </div>
                    <div class="col-lg-3 text-center">
                        <div class="product-item">
                            <h3>$47</h3>
                            <img src="/images/16646684053.20181217180044.jpg" alt="product-img" class="img-fluid">
                            <h4>C920 PRO</h4>
                            <a href="#" class="product-btn addToCartButton" data-product-name="C920 PRO" data-amount="47">Add to Cart</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- PRODUCT AREA END -->

<!-- JOIN AREA START -->

<!-- JOIN AREA END -->

<!-- BLOG AREA START -->
<section id="blog">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 heading">
                <h3>Blogs</h3>
            </div>
        </div>
        <div class="row blog-pa">
            <div class="col-lg-12">
                <div class="blog-main">
                    <div class="col-lg-4 blog-item">
                        <img src="/images/zuckerberg-quest-3-341x220.png" alt="blog-img" class="img-fluid">
                        <div class="blog-txt">
                            <span>24 min ago</span>
                            <a href="#">Meta is Reportedly Partnering with LG to Create Apple Vision Pro Competitor</a>
                        </div>
                    </div>
                    <div class="col-lg-4 blog-item">
                        <img src="/images/ea-wrc-341x220.png" alt="blog-img" class="img-fluid">
                        <div class="blog-txt">
                            <span>1 day ago</span>
                            <a href="#">‘DiRT Rally’ Studio Announces ‘EA Sports WRC’, PC VR Support Coming Post-launch</a>
                        </div>
                    </div>
                    <div class="col-lg-4 blog-item">
                        <img src="/images/border-bots-vr-341x220.png" alt="blog-img" class="img-fluid">
                        <div class="blog-txt">
                            <span>55 min ago</span>
                            <a href="#">‘Border Bots’ is Like ‘Papers, Please’ for VR, Coming to SteamVR & PSVR 2 This Month</a>
                        </div>
                    </div>
                    <div class="col-lg-4 blog-item">
                        <img src="/images/quest-3-341x220.png" alt="blog-img" class="img-fluid">
                        <div class="blog-txt">
                            <span>3 week ago</span>
                            <a href="#">European Pricing for Quest 3 Accessories Allegedly Leaked</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="blog-arrow text-center">
                    <i class="fa fa-angle-left arrow-al" aria-hidden="true"></i>
                    <i class="fa fa-angle-right arrow-ar" aria-hidden="true"></i>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- BLOG AREA END -->

<!-- SUBSCRIBE AREA START -->

<!-- SUBSCRIBE AREA END -->

<!-- FOOTER AREA START -->
<section id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 footer-logo">
                <a href="/">Logy<b>.</b></a>
                <p>Step into the Future with logy: Elevating Reality through VR Treadmills and Software Solutions</p>
                <div class="footer-social">
                    <a href="#"><i class="fa fa-twitch" aria-hidden="true"></i></a>
                    <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                    <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- FOOTER AREA END -->

<!-- COPY_RIGHT AREA START -->
<section id="copy_right">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-6 col-sm-7 copy-right-txt">
                        <p><i class="fa fa-copyright" aria-hidden="true"></i> 2021-2030 - Developed by <a href="#">Logy Team.</a></p>
                    </div>
                    <div class="col-lg-6 col-sm-5 text-right copy-right-txt">
                        <p>All Rights Reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- COPY_RIGHT AREA END -->

<!-- JavaScript -->
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/slick.min.js"></script>
<script src="/js/venobox.min.js"></script>
<script src="/js/lightbox.min.js"></script>
<script src="/js/counterup.min.js"></script>
<script src="/js/waypoints.min.js"></script>
<script src="/js/custom.js"></script>
<script src="/js/app.js"></script>
<script>
    $(document).ready(function() {
        var csrfToken = $('meta[name="_csrf"]').attr('content');
        var csrfHeader = $('meta[name="_csrf_header"]').attr('content');

        $('#logoutBtn, #logoutBtnMobile').click(function(e) {
            e.preventDefault();
            logout();
        });

        function logout() {
            $.ajax({
                url: '/logout',
                method: 'POST',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader(csrfHeader, csrfToken); // CSRF 헤더 설정
                },
                success: function(response) {
                    window.location.href = '/';
                },
                error: function(xhr, status, error) {
                    alert("Logout failed: " + error);
                }
            });
        }

        function checkAuthentication() {
            var loginBtn = $('#loginBtn');
            var logoutBtn = $('#logoutBtn');
            var loginBtnMobile = $('#loginBtnMobile');
            var logoutBtnMobile = $('#logoutBtnMobile');

            function handleViewportChange() {
                var viewportWidth = window.innerWidth || document.documentElement.clientWidth;

                if (viewportWidth < 992) {
                    loginBtn.hide();
                    logoutBtn.hide();
                    $.ajax({
                        url: '/check-authentication',
                        method: 'GET',
                        success: function(response) {
                            if (response.authenticated) {
                                loginBtnMobile.hide();
                                logoutBtnMobile.show();
                            } else {
                                loginBtnMobile.show();
                                logoutBtnMobile.hide();
                            }
                        }
                    });
                } else {
                    $.ajax({
                        url: '/check-authentication',
                        method: 'GET',
                        success: function(response) {
                            if (response.authenticated) {
                                loginBtn.hide();
                                logoutBtn.show();
                            } else {
                                loginBtn.show();
                                logoutBtn.hide();
                            }
                        }
                    });
                }
            }

            handleViewportChange();
            window.addEventListener('resize', handleViewportChange);

            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        // Logic when authenticated
                    } else {
                        // Logic when not authenticated
                    }
                }
            });
        }

        checkAuthentication();

        let allProductNames = "";
        function loadCartItems() {
            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        let currentMemberId = response.username;

                        $.ajax({
                            url: '/get-cart-items',
                            method: 'GET',
                            data: {memberId: currentMemberId},
                            success: function(response) {
                                let productNames = response.map(cartItem => cartItem.productName);
                                allProductNames = productNames.join(', ');

                                let cartItemsContainer = $('#cartItemsContainer');
                                let cartItemsContainer2 = $('#cartItemsContainer2');
                                cartItemsContainer.empty();
                                cartItemsContainer2.empty();
                                let totalAmount = response.reduce((sum, cartItem) => sum + parseFloat(cartItem.amount), 0);

                                $('#subtotal-value').text(`$${totalAmount.toFixed(2)}`);
                                $('#total-value').text(`$${totalAmount.toFixed(2)}`);
                                $('#checkoutButton').text(`Checkout $${totalAmount.toFixed(2)}`);
                                $('#cartItemCount').text(response.length);
                                $('#cartItemCountNavbar').text(response.length);

                                response.forEach(cartItem => {
                                    let imagePath = "";
                                    switch (cartItem.productName) {
                                        case "PICO 4":
                                            imagePath = "/images/35059704619.20221216134925.jpg";
                                            break;
                                        case "C920 PRO":
                                            imagePath = "/images/16646684053.20181217180044.jpg";
                                            break;
                                        case "Oculus Quest 2":
                                            imagePath = "/images/30612946625.20230130153345.jpg";
                                            break;
                                        case "VRlogy treadmill":
                                            imagePath = "/images/KATWALKC2.jpg";
                                            break;
                                        case "VRlogy Program":
                                            imagePath = "/images/KakaoTalk_Photo_2023-09-07-23-39-23.png";
                                            break;
                                        default:
                                            imagePath = "";
                                            break;
                                    }

                                    let itemHtml = `
                                                <div class="col-lg-6 col-sm-6">
                                                    <div class="cart-items text-center">
                                                        <img src="${imagePath}" alt="${cartItem.productName}" width="100">
                                                        <h3>$${cartItem.amount}</h3>
                                                        <h4>${cartItem.productName}</h4>
                                                        <a href="#" class="deleteCartItem" data-product-name="${cartItem.productName}"><i class="fa fa-times" aria-hidden="true"></i></a>
                                                    </div>
                                                </div>
                                            `;

                                    let itemHtml2 = `
                                            <div class="row cart-item">
                                                <div class="col-sm-4 col-lg-4 cart-img">
                                                    <img src="${imagePath}" alt="${cartItem.productName}" class="img-fluid">
                                                    <a href="#" class="deleteCartItem" data-product-name="${cartItem.productName}"><i class="fa fa-trash" aria-hidden="true"></i></a>
                                                </div>
                                                <div class="col-sm-8 col-lg-8">
                                                    <h3>${cartItem.productName}</h3>
                                                    <span>$${cartItem.amount}</span>
                                                </div>
                                            </div>
                                        `;

                                    cartItemsContainer.append(itemHtml);
                                    cartItemsContainer2.append(itemHtml2);
                                });

                                $('#cartItemsContainer, #cartItemsContainer2').on('click', '.deleteCartItem', function(e) {
                                    e.preventDefault();
                                    let productName = $(this).data('product-name');
                                    $.ajax({
                                        url: '/delete-cart-item',
                                        method: 'POST',
                                        contentType: 'application/json',
                                        data: JSON.stringify({ productName: productName, memberId: currentMemberId }),
                                        beforeSend: function(xhr) {
                                            xhr.setRequestHeader(csrfHeader, csrfToken); // CSRF 헤더 설정
                                        },
                                        success: function(deleteResponse) {
                                            if (deleteResponse.status === "success") {
                                                loadCartItems();
                                            } else {
                                                alert(deleteResponse.message);
                                            }
                                        },
                                        error: function() {
                                            // 빈칸
                                        }
                                    });
                                });
                            },
                            error: function() {
                                alert("Failed to load cart items.");
                            }
                        });
                    } else {
                        // 로그인 없이 카트 결제 시도 시
                    }
                }
            });
        }

        $('.addToCartButton').click(addToCartHandler);

        $('#checkoutButton').click(checkoutHandler);

        loadCartItems();

        function addToCartHandler(e) {
            e.preventDefault();
            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        let username = response.username;
                        let productName = $(e.target).data('product-name');
                        let amount = $(e.target).data('amount');

                        let cartData = {
                            memberId: username,
                            productName: productName,
                            amount: amount
                        };

                        console.log("Sending data to server:", JSON.stringify(cartData)); // 데이터 로그

                        $.ajax({
                            url: '/cart',
                            method: 'POST',
                            contentType: 'application/json',
                            data: JSON.stringify(cartData),
                            beforeSend: function(xhr) {
                                xhr.setRequestHeader(csrfHeader, csrfToken); // CSRF 헤더 설정
                            },
                            success: function(cartResponse) {
                                if (cartResponse.status === "success") {
                                    alert(cartResponse.message);
                                    loadCartItems();
                                } else {
                                    alert(cartResponse.message);
                                }
                            },
                            error: function(xhr, status, error) {
                                console.error("Error adding to cart:", error); // 오류 로그
                                alert("Failed to add to cart: " + error);
                            }
                        });
                    } else {
                        alert("Please login");
                    }
                },
                error: function(xhr, status, error) {
                    console.error("Error checking authentication:", error); // 오류 로그
                    alert("Failed to check authentication: " + error);
                }
            });
        }

        function checkoutHandler(e) {
            e.preventDefault();
            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        window.location.href = "cart";
                    } else {
                        alert("Please login");
                        window.location.href = "/";
                    }
                },
                error: function() {
                    alert("Failed to check authentication.");
                }
            });
        }

        $('#myPageBtn, #myPageBtnMobile').click(function(e) {
            e.preventDefault();
            $.ajax({
                url: '/check-authentication',
                method: 'GET',
                success: function(response) {
                    if (response.authenticated) {
                        window.location.href = 'mypage';
                    } else {
                        window.location.href = '/';
                    }
                },
                error: function() {
                    alert("Failed to check authentication.");
                }
            });
        });

        // vrlogy 소개 슬라이드 초기화
        $('.treadmill-slider-for').slick({
            slidesToShow: 1,
            slidesToScroll: 1,
            arrows: false,  // 이전, 다음 버튼 제거
            fade: false,
            asNavFor: '.treadmill-slider-nav',
            responsive: [
                {
                    breakpoint: 576,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                    }
                }
            ]
        });

        $('.treadmill-slider-nav').slick({
            slidesToShow: 8,
            slidesToScroll: 1,
            asNavFor: '.treadmill-slider-for',
            dots: false,  // 숫자 네비게이션 제거
            centerMode: true,
            focusOnSelect: true,
            responsive: [
                {
                    breakpoint: 576,
                    settings: {
                        slidesToShow: 4,
                        slidesToScroll: 1,
                    }
                }
            ]
        });
    });
</script>
</body>

</html>
